<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Server-Side-Request Forgery (SSRF)</title>
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <nav id="outline-content">
        <div id="outline">
            <strong>Съдържание: </strong>
            <ul>
                <li>
                    <a href="#ssrf">Server-Side-Request Forgery (SSRF)</a>
                </li>
                <li>
                    <a href="#кратко-описание">Кратко описание</a>
                </li>
                <li>
                    <a href="#въздействие-на-атаките">Какво е въздействието на SSRF атаките?</a>
                </li>
                <li>
                    <a href="#често-срещани-ssrf-атаки">Често срещани SSRF атаки</a>
                    <ul>
                        <li>
                            <a href="#ssrf-атаки-срещу-сървъра">SSRF атаки срещу сървъра</a>
                            <ul></ul>
                        </li>
                        <li>
                            <a href="#ssrf-атаки-срещу-други-бек-енд-системи">SSRF атаки срещу други бек-енд
                                системи</a>
                            <ul></ul>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#заобикаляне-на-общи-защити">Заобикаляне на общи защити на SSRF</a>
                    <ul>
                        <li>
                            <a href="#ssrf-с-входни-филтри-базирани-на-черен-списък">SSRF с входни филтри, базирани на
                                черен списък</a>
                            <ul></ul>
                        </li>
                        <li>
                            <a href="#ssrf-с-входни-филтри-базирани-на-бял-списък">SSRF с входни филтри, базирани на бял
                                списък</a>
                            <ul></ul>
                        </li>
                        <li>
                            <a href="#заобикаляне-на-ssrf-филтри-чрез-отворено-пренасочване">Заобикаляне на SSRF филтри
                                чрез отворено пренасочване</a>
                            <ul></ul>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#как-да-се-предотврати">Как да се предотврати?</a>
                </li>
                <li>
                    <a href="#примерни-сценарии-за-атака">Примерни сценарии за атака</a>
                </li>
                <li>
                    <a href="#burp-suite">Burp Suite</a>
                </li>
                <li>
                    <a href="#игра-с-примерна-ssrf-атака">Игра с примерна SSRF атака</a>
                </li>
                <li>
                    <a href="#използвани-ресурси">Използвани ресурси</a>
                    <ul></ul>
                </li>
            </ul>
        </div>
    </nav>
    <main id="container">
        <div id="content">
            <h1>
                <a id="ssrf"></a>
                Server-Side-Request Forgery <br /><br /> (SSRF)
            </h1>
            <img id="logo" src="img/TOP_10_Icons_Final_SSRF.png" alt="заглавно лого" />
            <section>
                <p>
                    Фалшифициране на заявка от страна на сървъра (SSRF) е уязвимост, която позволява на атакуващ да
                    принуди
                    приложението да изпрати заявка към нежелано местоположение.
                </p>
            </section>
            <hr />
            <section>
                <h2>
                    <a id="кратко-описание"></a>
                    Кратко описание
                </h2>
                <p>
                    <strong>Server-Side Request Forgery (SSRF)</strong> или на български <strong>Фалшифициране на заявка
                        от страна на сървъра</strong> е
                    уязвимост на уеб сигурността, която позволява на хакер да накара приложението от страна на сървъра
                    да прави заявки към
                    нежелано местоположение.

                    При типична SSRF атака нападателят може да накара сървъра да направи връзка само с вътрешни услуги в
                    рамките на
                    инфраструктурата на организацията. В други случаи те могат да принудят сървъра да се свърже с
                    произволни външни системи.
                    Това може да доведе до изтичане на чувствителни данни, като идентификационни данни за оторизация.
                </p>
                <p>
                    SSRF пропуски се появяват винаги, когато уеб приложение извлича отдалечен ресурс, без да валидира
                    предоставения от
                    потребителя URL адрес. Тя позволява на атакуващ да принуди приложението да изпрати създадена заявка
                    до неочаквана
                    дестинация, дори когато е защитено от защитна стена, VPN или друг тип списък за контрол на достъпа
                    до мрежата (ACL).

                    Тъй като модерните уеб приложения предоставят на крайните потребители удобни функции, извличането на
                    URL се превръща в
                    обичаен сценарий. В резултат на това честотата на SSRF нараства. Освен това сериозността на SSRF
                    става все по-висока
                    поради облачните услуги и сложността на архитектурите.
                </p>
                <p>
                    <img id="third-party" src="img/intro-photo-1-3rd-party.png" alt="3rd-party" />
                <p id="figure-description">Фигура 1: Third-party SSRF</p>
                </p>
            </section>
            <hr />
            <section>
                <h2>
                    <a id="въздействие-на-атаките"></a>
                    Какво е въздействието на SSRF атаките?
                </h2>
                <p>
                    Успешната SSRF атака често може да доведе до неоторизирани действия или достъп до данни в
                    организацията. Това може да е
                    в уязвимото приложение или в други бек-енд системи, с които приложението може да комуникира. В някои
                    ситуации
                    уязвимостта на SSRF може да позволи на атакуващ да извърши произволно изпълнение на команда.

                    Експлойт на SSRF, който причинява връзки към външни системи на трети страни, може да доведе до
                    злонамерени последващи
                    атаки. Може да изглежда, че произхождат от организацията, хостваща уязвимото приложение.
                </p>
            </section>
            <hr />
            <section>
                <h2>
                    <a id="често-срещани-ssrf-атаки"></a>
                    Често срещани SSRF атаки
                </h2>
                <p>
                    SSRF атаките често експлоатират отношения на доверие, за да ескалират атака от уязвимото приложение
                    и да извършат
                    неупълномощени действия. Тези отношения на доверие може да съществуват по отношение на сървъра или
                    по отношение на други
                    бек-енд системи в рамките на същата организация.
                </p>
                <h3>
                    <a id="ssrf-атаки-срещу-сървъра"></a>
                    SSRF атаки срещу сървъра
                </h3>
                <p>
                    При SSRF атака срещу сървъра, нападателят кара приложението да направи HTTP заявка обратно към
                    сървъра, който хоства
                    приложението, чрез неговия мрежов интерфейс за обратна връзка. Това обикновено включва предоставяне
                    на URL с име на хост
                    като 127.0.0.1(запазен IP адрес, който сочи към адаптера за обратна връзка) или localhost(често
                    използвано име за същия
                    адаптер).

                    Например, представете си приложение за пазаруване, което позволява на потребителя да види дали даден
                    артикул е наличен в
                    определен магазин. За да предостави информация за запасите, приложението трябва да направи запитване
                    към различни REST
                    API в задния край. Той прави това, като предава URL адреса към съответната крайна точка на API в
                    задния край чрез HTTP
                    заявка от предния край. Когато потребител прегледа състоянието на наличността за артикул, неговият
                    браузър прави
                    следната заявка:
                </p>
                <p>
                <pre class="code-snippet"><code>
    POST /product/stock HTTP/1.0
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 118

    stockApi=http://stock.weliketoshop.net:8080/product/stock/check%3FproductId%3D6%26storeId%3D1
                        </code>
                    </pre>
                </p>
                <p>
                    Това кара сървъра да направи заявка до посочения URL адрес, да извлече състоянието на запасите и да
                    го върне на
                    потребителя.

                    В този пример нападателят може да промени заявката, за да посочи URL адрес, локален за сървъра:
                </p>
                <p>
                <pre class="code-snippet">
                        <code>
    POST /product/stock HTTP/1.0
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 118

    stockApi=http://localhost/admin
                        </code>
                    </pre>
                </p>
                <p>
                    Сървърът извлича съдържанието на /adminURL адреса и го връща на потребителя.

                    Нападателят може да посети /adminURL адреса, но административната функция обикновено е достъпна само
                    за удостоверени
                    потребители. Това означава, че нападателят няма да види нищо интересно. Въпреки това, ако заявката
                    към /adminURL идва от
                    локалната машина, нормалните контроли за достъп се заобикалят. Приложението предоставя пълен достъп
                    до административната
                    функционалност, тъй като изглежда, че заявката идва от надеждно място.
                </p>
                <p>
                    Защо приложенията се държат по този начин и имплицитно се доверяват на заявки, които идват от
                    локалната машина? Това
                    може да възникне по различни причини:
                <ul>
                    <li>Проверката за контрол на достъпа може да бъде реализирана в различен компонент, който се намира
                        пред сървъра на
                        приложения. Когато се направи връзка обратно към сървъра, проверката се заобикаля.
                    </li>
                    <li>
                        За целите на възстановяване след бедствие приложението може да позволи административен достъп
                        без влизане на всеки
                        потребител, идващ от локалната машина. Това предоставя начин на администратора да възстанови
                        системата, ако загуби
                        своите идентификационни данни. Това предполага, че само напълно доверен потребител ще дойде
                        директно от сървъра.
                    </li>
                    <li>
                        Административният интерфейс може да слуша на различен номер на порт спрямо основното приложение
                        и да не е достъпен
                        директно от потребителите.
                    </li>
                </ul>
                Този вид доверителни отношения, при които заявките, произхождащи от локалната машина, се обработват по
                различен начин от
                обикновените заявки, често превръщат SSRF в критична уязвимост.
                </p>
                <h3>
                    <a id="ssrf-атаки-срещу-други-бек-енд-системи"></a>
                    SSRF атаки срещу други бек-енд системи
                </h3>
                <p>
                    В някои случаи сървърът на приложения може да взаимодейства с бек-енд системи, които не са директно
                    достъпни от
                    потребителите. Тези системи често имат немаршрутизирани частни IP адреси. Бек-енд системите
                    обикновено са защитени от
                    топологията на мрежата, така че често имат по-слаба защита. В много случаи вътрешните бек-енд
                    системи съдържат
                    чувствителна функционалност, която може да бъде достъпна без удостоверяване от всеки, който може да
                    взаимодейства със
                    системите.

                    В предишния пример си представете, че има административен интерфейс на задния URL адрес
                    https://192.168.0.68/admin.
                    Нападателят може да изпрати следната заявка, за да използва уязвимостта на SSRF и да получи достъп
                    до административния
                    интерфейс:
                </p>
                <p>
                <pre class="code-snippet">
                    <code>
    POST /product/stock HTTP/1.0
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 118
                        
    stockApi=http://192.168.0.68/admin
                        </code>
                    </pre>
                <p>
                    <img src="img/vectra-ssrf-diagram.png" alt="attack-diagram" />
                <p id="figure-description">Фигура 2: Диаграма на процеса на SSRF</p>
                </p>
                </p>
            </section>
            <hr />
            <section>
                <h2>
                    <a id="заобикаляне-на-общи-защити"></a>
                    Заобикаляне на общи защити на SSRF
                </h2>
                <p>
                    Обичайно е да видите приложения, съдържащи SSRF поведение заедно със защити, насочени към
                    предотвратяване на злонамерена
                    експлоатация. Често тези защити могат да бъдат заобиколени.
                </p>
                <h3>
                    <a id="ssrf-с-входни-филтри-базирани-на-черен-списък"></a>
                    SSRF с входни филтри, базирани на черен списък
                </h3>
                <p>
                    Някои приложения блокират въвеждане, съдържащо имена на хостове като 127.0.0.1 и localhost или
                    чувствителни URL адреси
                    като /admin. В тази ситуация често можете да заобиколите филтъра, като използвате следните техники:
                <ul>
                    <li>
                        Използвайте алтернативно IP представяне на 127.0.0.1, като 2130706433, 017700000001 или 127.1.
                    </li>
                    <li>
                        Регистрирайте собствено име на домейн, което се преобразува в 127.0.0.1. Можете да използвате
                        burp collaborator за тази цел.
                    </li>
                    <li>
                        Объркайте блокираните низове, като използвате URL кодиране или вариация на регистъра.
                    </li>
                    <li>
                        Предоставете URL адрес, който контролирате, който пренасочва към целевия URL адрес. Опитайте да
                        използвате различни
                        кодове за пренасочване, както и различни протоколи за целевия URL адрес. Например, доказано е ,
                        че превключването от
                        http: към https: URL по време на пренасочването заобикаля някои анти-SSRF филтри.
                    </li>
                </ul>
                </p>
                <h3>
                    <a id="ssrf-с-входни-филтри-базирани-на-бял-списък"></a>
                    SSRF с входни филтри, базирани на бял списък
                </h3>
                <p>
                    Някои приложения позволяват само входове, които съвпадат, бял списък с разрешени стойности. Филтърът
                    може да търси
                    съвпадение в началото на входа или да се съдържа в него. Може да успеете да заобиколите този филтър,
                    като се възползвате
                    от несъответствията в анализа на URL адреса.

                    Спецификацията на URL адреса съдържа редица функции, които е вероятно да бъдат пренебрегнати, когато
                    URL адресите
                    прилагат ad-hoc анализ и валидиране с помощта на този метод:
                <ul>
                    <li>
                        Можете да вградите идентификационни данни в URL адрес преди името на хоста, като използвате
                        @знака. Например:

                        https://expected-host:fakepassword@evil-host
                    </li>
                    <li>
                        Можете да използвате #знака, за да посочите URL фрагмент. Например:

                        https://evil-host#expected-host
                    </li>
                    <li>
                        Можете да използвате йерархията на DNS именуване, за да поставите необходимия вход в напълно
                        квалифицирано DNS име,
                        което контролирате. Например:

                        https://expected-host.evil-host
                    </li>
                    <li>
                        Можете да кодирате URL знаци, за да объркате кода за парсиране на URL. Това е особено полезно,
                        ако кодът, който
                        имплементира филтъра, обработва знаци, кодирани с URL, по различен начин от кода, който
                        изпълнява задната HTTP заявка.
                        Можете също така да опитате двойно кодирани знаци; някои сървъри рекурсивно URL-декодират
                        входните данни, които
                        получават, което може да доведе до допълнителни несъответствия.
                    </li>
                    <li>
                        Можете да използвате комбинации от тези техники заедно.
                    </li>
                </ul>
                </p>
                <h3>
                    <a id="заобикаляне-на-ssrf-филтри-чрез-отворено-пренасочване"></a>
                    Заобикаляне на SSRF филтри чрез отворено пренасочване
                </h3>
                <p>
                    Понякога е възможно да се заобиколят защитите, базирани на филтър, като се използва отворена
                    уязвимост на пренасочване.

                    В предишния пример си представете, че изпратеният от потребител URL адрес е стриктно валидиран, за
                    да се предотврати
                    злонамерено използване на поведението на SSRF. Въпреки това, приложението, чиито URL адреси са
                    разрешени, съдържа
                    отворена уязвимост при пренасочване. При условие, че API, използван за създаване на задната HTTP
                    заявка, поддържа
                    пренасочвания, можете да създадете URL, който удовлетворява филтъра и води до пренасочена заявка към
                    желаната обратна
                    цел.

                    Например, приложението съдържа отворена уязвимост при пренасочване, в която следният URL адрес:
                <pre class="code-snippet">
                        <code>
    /product/nextProduct?currentProductId=6&path=http://evil-user.net
                            </code>
                            </pre>
                връща пренасочване към:
                <pre class="code-snippet">
                                        <code>
    http://evil-user.net
                                            </code>
                                            </pre>
                Можете да използвате уязвимостта на отвореното пренасочване, за да заобиколите URL филтъра и да
                използвате уязвимостта
                на SSRF, както следва:
                <p>
                <pre class="code-snippet">
                                        <code>
    POST /product/stock HTTP/1.0
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 118

    stockApi=http://weliketoshop.net/product/nextProduct?currentProductId=6&path=http://192.168.0.68/admin
                                            </code>
                                            </pre>
                </p>
                Този експлойт на SSRF работи, защото приложението първо проверява дали предоставеният stockAPIURL адрес
                е в разрешен
                домейн, което и е. След това приложението изисква предоставения URL адрес, който задейства отвореното
                пренасочване. Той
                следва пренасочването и прави заявка към вътрешния URL адрес по избор на атакуващия.
                </p>
            </section>
            <hr />
            <section>
                <h2>
                    <a id="как-да-се-предотврати"></a>
                    Как да се предотврати?
                </h2>
                <p>
                    Разработчиците могат да предотвратят SSRF, като внедрят някои или всички следните защити в дълбоките
                    контроли:
                </p>
                <h3>
                    <a id="от-мрежовия-слой"></a>
                    От мрежовия слой
                </h3>
                <p>
                <ul>
                    <li>
                        Сегментирайте функционалността за отдалечен достъп до ресурси в отделни мрежи, за да намалите
                        въздействието на SSRF.
                    </li>
                    <li>
                        Приложете правила за защитна стена „отказ по подразбиране“ или правила за контрол на мрежовия
                        достъп, за да блокирате
                        целия интранет трафик, освен основния.
                        Съвети:
                        ~ Установете собственост и жизнен цикъл за правилата на защитната стена въз основа на
                        приложения.
                        ~ Регистрирайте всички приети и блокирани мрежови потоци на защитни стени.
                    </li>
                </ul>
                </p>
                <h3>
                    <a id="от-приложния-слой"></a>
                    От приложния слой
                </h3>
                <p>
                <ul>
                    <li>
                        Валидирайте всички въведени данни, предоставени от клиента.
                    </li>
                    <li>
                        Приложете URL схемата, порта и дестинацията с положителен разрешен списък.
                    </li>
                    <li>
                        Не изпращайте необработени отговори на клиентите.
                    </li>
                    <li>
                        Деактивирайте HTTP пренасочванията.
                    </li>
                    <li>
                        Бъдете наясно с последователността на URL адресите, за да избегнете атаки като повторно
                        свързване на DNS и условия на
                        състезание „време на проверка, време на използване“ (TOCTOU).
                    </li>
                </ul>
                Не смекчавайте SSRF чрез използване на списък за отказ или регулярен израз. Нападателите имат списъци с
                полезен товар,
                инструменти и умения за заобикаляне на списъците за отказ.
                </p>
                <h3>
                    <a id="допълнителни-мерки"></a>
                    Допълнителни мерки, които трябва да се вземат предвид
                </h3>
                <p>
                <ul>
                    <li>
                        Не внедрявайте други свързани със сигурността услуги на предни системи (напр. OpenID).
                        Контролирайте локалния трафик на
                        тези системи (напр. localhost).
                    </li>
                    <li>
                        За интерфейси със специални и управляеми потребителски групи използвайте мрежово криптиране
                        (напр. VPN) на независими
                        системи, за да вземете предвид много високите нужди от защита.
                    </li>
                </ul>
                </p>
            </section>
            <hr />
            <section>
                <h2>
                    <a id="примерни-сценарии-за-атака"></a>
                    Примерни сценарии за атака
                </h2>
                <p>
                    Нападателите могат да използват SSRF, за да атакуват системи, защитени зад защитни стени на уеб
                    приложения, защитни
                    стени или мрежови ACL, като използват сценарии като:
                </p>
                <h3>
                    <a id="сценарий-1"></a>
                    Сценарий #1:
                </h3>
                <p>
                    Сканиране на портове вътрешни сървъри – Ако мрежовата архитектура не е сегментирана, атакуващите
                    могат да начертаят
                    вътрешните мрежи и да определят дали портовете са отворени или затворени на вътрешните сървъри от
                    резултатите от
                    връзката или изминалото време за свързване или отхвърляне на SSRF връзки с полезен товар.
                </p>
                <h3>
                    <a id="сценарий-2"></a>
                    Сценарий #2:
                </h3>
                <p>
                    Излагане на чувствителни данни – Нападателите могат да получат достъп до локални файлове или
                    вътрешни услуги, за да
                    получат чувствителна информация като file:///etc/passwdи http://localhost:28017/.
                </p>
                <h3>
                    <a id="сценарий-3"></a>
                    Сценарий #3:
                </h3>
                <p>
                    Достъп до хранилище на метаданни на облачни услуги – Повечето доставчици на облачни услуги имат
                    хранилище на метаданни
                    като http://169.254.169.254/. Нападателят може да прочете метаданните, за да получи чувствителна
                    информация.
                </p>
                <h3>
                    <a id="сценарий-4"></a>
                    Сценарий #4:
                </h3>
                <p>
                    Компрометиране на вътрешни услуги – Нападателят може да злоупотреби с вътрешни услуги, за да извърши
                    допълнителни атаки,
                    като например дистанционно изпълнение на код (RCE) или отказ от услуга (DoS).
                </p>
            </section>
            <hr />
            <section>
                <h2>
                    <a id="burp-suite"></a>
                    Burp Suite
                </h2>
                <p>
                    Burp Suite е мощен инструмент за тестване на сигурността на уеб приложения, създаден от компанията
                    PortSwigger. Той се
                    използва основно за откриване на уязвимости в уеб приложенията, като например SQL injections, XSS
                    (Cross-Site Scripting) и
                    други. Burp Suite предлага набор от инструменти, включително прокси сървър за прихващане на
                    HTTP/HTTPS трафик, скенер за
                    уязвимости и инструменти за ръчно тестване.
                    <br>
                    Този софтуер е популярен сред специалистите по киберсигурност и се използва за:
                <ul>
                    <li>
                        <strong>Тестване на проникване (penetration testing):</strong> За да се идентифицират слабости в
                        сигурността на уеб приложенията.
                    </li>
                    <li>
                        <strong>Анализ на трафик:</strong> Позволява прихващане и модифициране на мрежовия трафик между
                        браузъра и сървъра.
                    </li>
                    <li>
                        <strong>Автоматизирано сканиране:</strong> За откриване на често срещани уязвимости.
                    </li>
                    <li>
                        <strong>Ръчно изследване:</strong> За по-задълбочен анализ на специфични проблеми.
                    </li>
                </ul>
                </p>
                <p>
                    <img src="img/burp-suite-initial-page.png" alt="burp-suite-initial-page" />
                </p>
                <p>
                    <img src="img/burp-suite-game-final.png" alt="burp-suite-game-final" />
                <p id="figure-description">Фигури 2 и 3: Визуализация на работата с Burp Suite</p>
                </p>
            </section>
            <hr />
            <section>
                <h2>
                    <a id="игра-с-примерна-ssrf-атака"></a>
                    Игра с примерна SSRF атака
                </h2>
                <div class="container mt-4">
                    <nav class="mb-4">
                        <button id="navProduct" class="btn btn-primary mr-2">Продукт</button>
                        <button id="navAdmin" class="btn btn-danger">Админ</button>
                    </nav>

                    <div id="app">
                        Целта на играта е да се демонстрира SSRF атака, която позволява на потребителя да получи достъп
                        до администраторския интерфейс на приложението и да изтрие потребител.
                        Вдъхновено от PortSwigger Labs:
                        <div id="productSection">
                            <h2>Продукт</h2>
                            <p>
                                Следвайте стъпките:<br>
                                • Първо натиснете <strong>Админ</strong> бутонът. Забележете как не може да се достъпи
                                съдържанието.<br>
                                • След това в <strong>Продукт</strong> страницата натиснете бутонът
                                <strong>Наличност</strong>.<br>
                                • В полето за попълване на <strong>stockApi</strong> променете съдържанието, за да
                                отключите
                                <strong>Админ</strong> секцията. Въведете в него следния URL адрес:
                            <pre class="code-snippet"><code>http://localhost/admin</code></pre>
                            • Прочетете съдържанието в <strong>Админ</strong> секцията и ще забележите как да
                            спечелите играта.<br>
                            • Накрая, върнете се в <strong>Продукт</strong> страницата и натиснете
                            <strong>Изпрати</strong>
                            бутона, за да изпратите SSRF атаката. Променете параметърът
                            <strong>stockApi</strong>
                            </p>

                            <div class="card mb-3">
                                <div class="card-body">
                                    <h5 class="card-title">Телевизор</h5>
                                    <p class="card-text">
                                        Невероятен телевизор за гледане на 3D, 4D, IMAX, ultra HD филми.
                                    </p>
                                    <button id="checkStockBtn" class="btn btn-info">Наличност</button>
                                </div>
                            </div>

                            <div id="requestPanel" class="mb-3" style="display: none;">
                                <div class="card">
                                    <div class="card-body">
                                        <h6>42 бройки</h6>
                                        <h5 class="card-title">Заявка</h5>
                                        <p>Променете <strong>stockApi</strong> параметърът и натиснете
                                            <strong>Изпрати</strong>.
                                        </p>
                                        <form id="stockForm">
                                            <div class="form-group">
                                                <label for="stockApi">stockApi</label>
                                                <input type="text" class="form-control" id="stockApi"
                                                    value="http://api.stock.com/check?productId=1">
                                            </div>
                                            <button type="submit" class="btn btn-success">Изпрати</button>
                                        </form>
                                    </div>
                                </div>
                            </div>

                            <div id="responseArea"></div>
                        </div>

                        <div id="adminSection" style="display: none;">
                            <h2>Администраторски интерфейс</h2>
                            <p>Добре дошли в Администраторския интерфейс! Забележете как до сега нямахте достъп до него!
                            </p>
                            <p>
                                <strong>Как да спечелите:</strong> Сега с администраторските си права можете да триете
                                потребители.
                                <br>
                            <pre class="code-snippet"><code>http://localhost/admin/delete?username=carlos</code></pre>
                            </p>
                            <p>
                                За да завършите играта и атаката да е успешна, върнете се в <strong>Продукт</strong>,
                                въведете дадения URL адрес в полето
                                <strong>stockApi</strong> и натиснете <strong>Изпрати</strong>.
                            </p>
                        </div>
                    </div>
                </div>
            </section>
            <hr />

            <section>
                <h2>
                    <a id="използвани-ресурси"></a>
                    Използвани ресурси
                </h2>
                <div>
                    <div><span>[1] </span>PortSwigger - <a href="https://portswigger.net/web-security/ssrf"
                            rel="noopener" target="_blank">https://portswigger.net/web-security/ssrf</a>
                        , последно посетен на 22.04.2025
                    </div>
                    <div><span>[2] </span>PortSwigger Labs - <a
                            href="https://portswigger.net/web-security/all-labs#server-side-request-forgery-ssrf"
                            rel="noopener"
                            target="_blank">https://portswigger.net/web-security/all-labs#server-side-request-forgery-ssrf</a>,
                        последно посетен на 22.04.2025
                    </div>
                    <div><span>[3] </span>PortSwigger първият Lab използван като пример за играта - <a
                            href="https://portswigger.net/web-security/ssrf/lab-basic-ssrf-against-localhost"
                            rel="noopener"
                            target="_blank">https://portswigger.net/web-security/ssrf/lab-basic-ssrf-against-localhost</a>,
                        последно посетен на 22.04.2025
                    </div>
                    <div><span>[4] </span>Burp Suite download - <a
                            href="https://portswigger.net/burp/documentation/desktop/getting-started/download-and-install"
                            rel="noopener"
                            target="_blank">https://portswigger.net/burp/documentation/desktop/getting-started/download-and-install</a>,
                        последно посетен на 22.04.2025
                    </div>
                    <div><span>[5] </span>Burp Suite tutorial - <a href="https://www.youtube.com/watch?v=LeM0AD4rXKY"
                            rel="noopener" target="_blank">https://www.youtube.com/watch?v=LeM0AD4rXKY</a>,
                        последно посетен на 22.04.2025
                    </div>
                    <div><span>[6] </span>Burp collaborator - <a
                            href="https://portswigger.net/burp/documentation/collaborator" rel="noopener"
                            target="_blank">https://portswigger.net/burp/documentation/collaborator</a>,
                        последно посетен на 22.04.2025
                    </div>
                    <div><span>[7] </span>Vectra - <a href="https://www.vectra.ai/topics/server-side-request-forgery"
                            rel="noopener" target="_blank">https://www.vectra.ai/topics/server-side-request-forgery</a>,
                        последно посетен на 22.04.2025
                    </div>
                    <div><span>[8] </span>Owasp Top 10 - <a
                            href="https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/"
                            rel="noopener"
                            target="_blank">https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/</a>,
                        последно посетен на 22.04.2025
                    </div>
                </div>
            </section>
        </div>
    </main>

    <script src="javascript/script.js"></script>
</body>

</html>